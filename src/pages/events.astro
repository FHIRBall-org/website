---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';

const events = await getCollection('events');
const sortedEvents = events.sort((a, b) =>
  b.data.startDate.getTime() - a.data.startDate.getTime()
);
---

<BaseLayout title="Industry Events" description="Meet the FHIRBall Alliance at healthcare industry events">
  <!-- Banner Section -->
  <section class="hero-bg relative py-20 bg-cover bg-center bg-no-repeat">
    <div class="max-w-[1200px] mx-auto px-[10px] text-center">
      <h1 class="text-[40px] md:text-[50px] lg:text-[60px] font-bold text-white uppercase">INDUSTRY <strong>EVENTS</strong></h1>
    </div>
  </section>

  <!-- Events List -->
  <section class="py-16">
    <div class="max-w-[1200px] mx-auto px-[10px]">
      <div class="space-y-8">
        {sortedEvents.map((event) => (
          <div class="flex flex-col md:flex-row gap-6 border border-border rounded overflow-hidden bg-white">
            {event.data.image && (
              <div class="md:w-[300px] md:shrink-0 px-4">
                <img
                  src={event.data.image}
                  alt={event.data.title}
                  class="w-full h-[200px] md:h-full object-contain"
                  loading="lazy"
                  decoding="async"
                />
              </div>
            )}
            <div class="flex-1 py-4 px-4 md:px-0 md:py-6">
              <h2 class="text-[22px] font-bold text-text">{event.data.title}</h2>
              <div class="flex flex-wrap gap-x-4 gap-y-1 mt-2 text-[14px] text-text-light">
                {event.data.location && (
                  <span>{event.data.location}</span>
                )}
                <span>
                  {event.data.startDate.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' })}
                  {event.data.endDate && ` - ${event.data.endDate.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' })}`}
                </span>
                {event.data.time && (
                  <span>{event.data.time}</span>
                )}
              </div>
              <p class="mt-3 text-[16px] leading-[24px] text-text">{event.data.description}</p>
            </div>
            <div class="px-4 pb-4 md:px-0 md:py-6 md:pr-6 flex items-center">
              <a
                href={event.data.externalUrl}
                target="_blank"
                rel="noopener noreferrer"
                class="inline-block border border-text text-text hover:bg-text hover:text-white px-6 py-2 font-medium transition-colors whitespace-nowrap"
              >
                Read More
              </a>
            </div>
          </div>
        ))}
      </div>
    </div>
  </section>
</BaseLayout>
